<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>AGGM Icon Studio</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="theme-color" content="#1a1a2e" />
<meta name="description" content="AGGM Icon Studio - A tool to browse, edit, and download SVG icons." />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="AGGM Icon Studio" />
<meta name="application-name" content="AGGM Icon Studio" />
<link rel="manifest" href="manifest.json" />
<link rel="apple-touch-icon" href="logo.png" />
<style>
  * {
    box-sizing: border-box;
  }
  
  body {
    margin: 0;
    padding: 1rem;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, #0f0f23, #1a1a2e);
    display: flex;
    height: 100vh;
    gap: 1rem;
    color: #e4e4e7;
  }
  
  #sidebar {
    width: 350px;
    background: linear-gradient(135deg, #1e1e2e, #252538);
    border-radius: 12px;
    border: 1px solid #374151;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    backdrop-filter: blur(10px);
  }
  
  #search {
    padding: 1rem;
    border: 2px solid #374151;
    margin: 1rem;
    border-radius: 8px;
    font-size: 1rem;
    background: #2d2d3a;
    color: #e4e4e7;
    transition: all 0.3s ease;
    outline: none;
  }
  
  #search:focus {
    border-color: #6366f1;
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
  }
  
  #search::placeholder {
    color: #9ca3af;
  }
  
  #icon-list {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    padding: 0 1rem 1rem;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: #4b5563 transparent;
  }
  
  #icon-list::-webkit-scrollbar {
    width: 6px;
  }
  
  #icon-list::-webkit-scrollbar-track {
    background: transparent;
  }
  
  #icon-list::-webkit-scrollbar-thumb {
    background: #4b5563;
    border-radius: 3px;
  }
  
  .icon-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    cursor: pointer;
    padding: 0.75rem;
    border-radius: 8px;
    transition: all 0.2s ease;
    border: 1px solid transparent;
  }
  
  .icon-item:hover {
    background: linear-gradient(135deg, #374151, #4b5563);
    border-color: #6b7280;
    transform: translateX(4px);
  }
  
  .icon-item.selected {
    background: linear-gradient(135deg, #6366f1, #8b5cf6);
    border-color: #a855f7;
  }
  
  .icon-item svg {
    width: 28px;
    height: 28px;
    flex-shrink: 0;
    filter: brightness(1.2);
  }
  
  .icon-name {
    flex-grow: 1;
    font-size: 0.95rem;
    color: #f3f4f6;
    font-weight: 500;
  }
  
  #studio {
    flex-grow: 1;
    background: linear-gradient(135deg, #1e1e2e, #252538);
    border-radius: 12px;
    border: 1px solid #374151;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    display: flex;
    flex-direction: column;
    padding: 1.5rem;
    backdrop-filter: blur(10px);
  }
  
  #icon-preview {
    border: 2px solid #374151;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 1.5rem;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 200px;
    background: linear-gradient(135deg, #2d2d3a, #3a3a4a);
    position: relative;
    overflow: hidden;
  }
  
  #icon-preview::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
      radial-gradient(circle at 20% 20%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 80% 80%, rgba(139, 92, 246, 0.1) 0%, transparent 50%);
    pointer-events: none;
  }
  
  #icon-preview svg {
    width: 140px;
    height: 140px;
    z-index: 1;
    position: relative;
    filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.3));
  }
  
  .controls-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }
  
  .control-group {
    display: flex;
    flex-direction: column;
  }
  
  label {
    font-weight: 600;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
    color: #f9fafb;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  
  input[type="color"] {
    width: 100%;
    height: 50px;
    padding: 0;
    border: 2px solid #374151;
    border-radius: 8px;
    background: #2d2d3a;
    cursor: pointer;
    transition: all 0.3s ease;
    outline: none;
  }
  
  input[type="color"]:hover {
    border-color: #6366f1;
    transform: scale(1.02);
  }
  
  input[type="color"]::-webkit-color-swatch-wrapper {
    padding: 0;
    border-radius: 6px;
    overflow: hidden;
  }
  
  input[type="color"]::-webkit-color-swatch {
    border: none;
    border-radius: 6px;
  }
  
  #svg-editor {
    flex-grow: 1;
    margin-top: 0.5rem;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 0.9rem;
    border: 2px solid #374151;
    border-radius: 8px;
    padding: 1rem;
    resize: vertical;
    min-height: 180px;
    overflow: auto;
    background: #1f2937;
    color: #e5e7eb;
    outline: none;
    transition: all 0.3s ease;
    line-height: 1.6;
  }
  
  #svg-editor:focus {
    border-color: #6366f1;
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
  }
  
  #svg-editor::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
  
  #svg-editor::-webkit-scrollbar-track {
    background: #374151;
    border-radius: 4px;
  }
  
  #svg-editor::-webkit-scrollbar-thumb {
    background: #6b7280;
    border-radius: 4px;
  }
  
  #buttons {
    margin-top: 1.5rem;
    display: flex;
    gap: 1rem;
  }
  
  button {
    flex: 1;
    padding: 0.75rem 1.5rem;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    border-radius: 8px;
    border: none;
    background: linear-gradient(135deg, #6366f1, #8b5cf6);
    color: white;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    position: relative;
    overflow: hidden;
  }
  
  button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
  }
  
  button:hover::before {
    left: 100%;
  }
  
  button:hover {
    background: linear-gradient(135deg, #5b21b6, #7c3aed);
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
  }
  
  button:active {
    transform: translateY(0);
  }
  
  .empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    color: #9ca3af;
    text-align: center;
  }
  
  .empty-state svg {
    width: 64px;
    height: 64px;
    margin-bottom: 1rem;
    opacity: 0.5;
  }
  
  .notification {
    position: fixed;
    top: 2rem;
    right: 2rem;
    background: linear-gradient(135deg, #059669, #10b981);
    color: white;
    padding: 1rem 1.5rem;
    border-radius: 8px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    transform: translateX(400px);
    transition: transform 0.3s ease;
    z-index: 1000;
    font-weight: 600;
  }
  
  .notification.show {
    transform: translateX(0);
  }
  
  .notification.error {
    background: linear-gradient(135deg, #dc2626, #ef4444);
  }
</style>
</head>
<body>

<div id="sidebar">
  <input type="text" id="search" placeholder="Search icons..." autocomplete="off" />
  <div id="icon-list"></div>
</div>

<div id="studio">
  <div id="icon-preview">
    <div class="empty-state">
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 2L2 7V10C2 16 6 20.5 12 22C18 20.5 22 16 22 10V7L12 2Z"/>
      </svg>
      <p>Select an icon to get started</p>
    </div>
  </div>

  <div class="controls-grid">
    <div class="control-group">
      <label for="fill-color">Fill Color</label>
      <input type="color" id="fill-color" value="#ffffff" />
    </div>
    <div class="control-group">
      <label for="stroke-color">Stroke Color</label>
      <input type="color" id="stroke-color" value="#ffffff" />
    </div>
  </div>

  <label for="svg-editor">Edit SVG Source</label>
  <textarea id="svg-editor" spellcheck="false" placeholder="SVG source code will appear here..."></textarea>

  <div id="buttons">
    <button id="copy-svg">Copy SVG</button>
    <button id="download-svg">Download SVG</button>
  </div>
</div>

<script>
(async function () {
  function fuzzyMatchScore(str, pattern) {
    str = str.toLowerCase();
    pattern = pattern.toLowerCase();
    let score = 0, j = 0;
    for (let i = 0; i < str.length && j < pattern.length; i++) {
      if (str[i] === pattern[j]) {
        score += 1;
        j++;
      }
    }
    return j === pattern.length ? score : 0;
  }

  function showNotification(message, isError = false) {
    const notification = document.createElement('div');
    notification.className = `notification ${isError ? 'error' : ''}`;
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => notification.classList.add('show'), 100);
    setTimeout(() => {
      notification.classList.remove('show');
      setTimeout(() => document.body.removeChild(notification), 300);
    }, 2000);
  }

  const icons = await (await fetch('icons.json')).json();

  const iconListEl = document.getElementById('icon-list');
  const searchInput = document.getElementById('search');
  const iconPreview = document.getElementById('icon-preview');
  const fillColorInput = document.getElementById('fill-color');
  const strokeColorInput = document.getElementById('stroke-color');
  const svgEditor = document.getElementById('svg-editor');
  const copyBtn = document.getElementById('copy-svg');
  const downloadBtn = document.getElementById('download-svg');

  let currentIcon = null;
  let currentSvgElement = null;
  let selectedIconItem = null;

  function renderIconList(filteredIcons) {
    iconListEl.innerHTML = '';
    for (const icon of filteredIcons) {
      const div = document.createElement('div');
      div.className = 'icon-item';
      div.title = `${icon.name} (${icon.style})`;

      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = icon.svg.trim();
      const svgEl = tempDiv.firstElementChild;

      svgEl.style.width = '28px';
      svgEl.style.height = '28px';
      svgEl.style.flexShrink = '0';

      const nameSpan = document.createElement('span');
      nameSpan.className = 'icon-name';
      nameSpan.textContent = icon.name;

      div.appendChild(svgEl);
      div.appendChild(nameSpan);

      div.addEventListener('click', () => {
        if (selectedIconItem) {
          selectedIconItem.classList.remove('selected');
        }
        div.classList.add('selected');
        selectedIconItem = div;
        selectIcon(icon);
      });

      iconListEl.appendChild(div);
    }
  }

  function selectIcon(icon) {
    currentIcon = icon;
    iconPreview.innerHTML = icon.svg;

    const tempDiv = document.createElement('div');
    tempDiv.innerHTML = icon.svg.trim();
    currentSvgElement = tempDiv.firstElementChild;

    const fill = currentSvgElement.getAttribute('fill') || '#ffffff';
    const stroke = currentSvgElement.getAttribute('stroke') || '#ffffff';
    fillColorInput.value = toHexColor(fill);
    strokeColorInput.value = toHexColor(stroke);

    updateSvgColors();
    svgEditor.value = formatXml(icon.svg);
  }

  function formatXml(xml) {
    const PADDING = '  ';
    const reg = /(>)(<)(\/*)/g;
    let formatted = '';
    let pad = 0;

    xml = xml.replace(reg, '$1\r\n$2$3');
    xml.split('\r\n').forEach(function(node) {
      let indent = 0;
      if (node.match(/.+<\/\w[^>]*>$/)) {
        indent = 0;
      } else if (node.match(/^<\/\w/)) {
        if (pad !== 0) pad -= 1;
      } else if (node.match(/^<\w([^>]*[^\/])?>.*$/)) {
        indent = 1;
      } else {
        indent = 0;
      }

      formatted += PADDING.repeat(pad) + node + '\r\n';
      pad += indent;
    });

    return formatted.trim();
  }

  function toHexColor(color) {
    const s = new Option().style;
    s.color = color;
    if (!s.color) return '#ffffff';
    document.body.appendChild(s);
    const div = document.createElement('div');
    div.style.color = color;
    document.body.appendChild(div);
    const computed = getComputedStyle(div).color;
    document.body.removeChild(div);
    const match = computed.match(/^rgba?\((\d+), (\d+), (\d+)/);
    if (!match) return '#ffffff';
    return (
      '#' +
      [1, 2, 3]
        .map(i => {
          const hex = parseInt(match[i]).toString(16);
          return hex.length === 1 ? '0' + hex : hex;
        })
        .join('')
    );
  }

  function updateSvgColors() {
    if (!currentSvgElement) return;

    const fillColor = fillColorInput.value;
    const strokeColor = strokeColorInput.value;

    currentSvgElement.setAttribute('fill', fillColor);
    currentSvgElement.setAttribute('stroke', strokeColor);

    const serializer = new XMLSerializer();
    const updatedSvgString = serializer.serializeToString(currentSvgElement);

    iconPreview.innerHTML = updatedSvgString;
    svgEditor.value = formatXml(updatedSvgString);
  }

  function onSvgEditorChange() {
    try {
      const parser = new DOMParser();
      const doc = parser.parseFromString(svgEditor.value, 'image/svg+xml');
      const svgEl = doc.documentElement;
      if (svgEl && svgEl.tagName === 'svg') {
        currentSvgElement = svgEl;
        iconPreview.innerHTML = svgEditor.value;
        const fill = currentSvgElement.getAttribute('fill') || '#ffffff';
        const stroke = currentSvgElement.getAttribute('stroke') || '#ffffff';
        fillColorInput.value = toHexColor(fill);
        strokeColorInput.value = toHexColor(stroke);
      }
    } catch {
      
    }
  }

  async function copySvgToClipboard() {
    try {
      await navigator.clipboard.writeText(svgEditor.value);
      showNotification('SVG copied to clipboard!');
    } catch {
      showNotification('Failed to copy SVG', true);
    }
  }

  function downloadSvgFile() {
    const blob = new Blob([svgEditor.value], { type: 'image/svg+xml' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = (currentIcon ? currentIcon.name : 'icon') + '.svg';
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
    showNotification('SVG downloaded successfully!');
  }

  function searchIcons(term) {
    if (!term) return icons;
    const filtered = icons
      .map(icon => ({ icon, score: fuzzyMatchScore(icon.name, term) }))
      .filter(({ score }) => score > 0)
      .sort((a, b) => b.score - a.score)
      .map(({ icon }) => icon);
    return filtered;
  }

  searchInput.addEventListener('input', () => {
    const filtered = searchIcons(searchInput.value.trim());
    renderIconList(filtered);
    if (filtered.length === 1) {
      const firstItem = iconListEl.firstElementChild;
      if (firstItem) {
        if (selectedIconItem) {
          selectedIconItem.classList.remove('selected');
        }
        firstItem.classList.add('selected');
        selectedIconItem = firstItem;
        selectIcon(filtered[0]);
      }
    }
  });

  fillColorInput.addEventListener('input', updateSvgColors);
  strokeColorInput.addEventListener('input', updateSvgColors);
  svgEditor.addEventListener('input', onSvgEditorChange);
  copyBtn.addEventListener('click', copySvgToClipboard);
  downloadBtn.addEventListener('click', downloadSvgFile);

  renderIconList(icons);
})();
</script>

</body>
</html>